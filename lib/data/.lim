#!/bin/bash

# Set the token and json files as variables
token=$(tail .token)
jsonfile=.limit

# Define the function
format ()
{
sed -i 's/["{}]//g' $jsonfile;
awk -F',' '{ for (i=1; i<=NF; i++) print $i }' $jsonfile
}

# Send the request
curl -o $jsonfile https://api.pushover.net/1/apps/limits.json?token=${token}

# Add some spacing
echo

# filter the json response with the function
format

# Add some spacing again
echo
